<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>vtk-dicom: Image Display</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">vtk-dicom
   &#160;<span id="projectnumber">0.8.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Image Display </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Correct display of pixel values.</p>
<p><a class="anchor" id="md_ImageDisplay"></a></p>
<h1><a class="anchor" id="autotoc_md31"></a>
Overview</h1>
<p>In general, the pixel values that are stored in a DICOM file cannot be directly displayed to the screen. Instead, the pixel values go through a <em>display pipeline</em> that changes the values to something suitable for viewing. Unless the pixels are stored in the file as RGB or as 8-bit grayscale, the display pipeline will generally do one of two things: it will map the values through a palette to generate RGB pixels, or it will rescale the values (sometimes in multiple steps) for monochrome display.</p>
<p>The <a class="el" href="classvtkDICOMReader.html" title="Read DICOM image files.">vtkDICOMReader</a> will, by default, produce the <em>Modality Values</em> of the pixels, which are the values associated with the modality that produced the images (e.g. Hounsfield values for CT). If desired, the AutoRescaleOff() method can be called on the reader to force it to produce <em>Stored Values</em> instead, which are the pixel values stored in the file. Note that <em>Modality Values</em> are equal to <em>Stored Values</em> for many modalities, including MRI and Ultrasound.</p>
<h1><a class="anchor" id="autotoc_md32"></a>
Photometric Interpretation</h1>
<p>The <a href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html">Image Pixel Module</a> of the DICOM standard defines the Photometric Interpretation attribute as a hint for how the stored pixel values should be interpreted by a DICOM image display pipeline. Typical values are:</p><ul>
<li>MONOCHROME1 - negative image, where higher values are darker (e.g. radiographic film )</li>
<li>MONOCHROME2 - positive image, where higher values are brighter (e.g. CT, MR)</li>
<li>PALETTE COLOR - indexed color with palette</li>
<li>RGB - full-color image with separate RGB components</li>
</ul>
<p>In addition to the above, the YBR family of photometric interpretations indicate that the image was stored with one luma channel and two color channels, which is commonly done when a color image is compressed. The <a class="el" href="classvtkDICOMReader.html" title="Read DICOM image files.">vtkDICOMReader</a> automatically converts YBR images to RGB, so display pipelines should interpret YBR the same as RGB.</p><ul>
<li>YBR_FULL - used by ultrasound, usually with RLE compression</li>
<li>YBR_FULL_422 - used by JPEG lossy compressed images</li>
<li>YBR_PARTIAL_420 - used by MPEG lossy compressed video</li>
<li>YBR_ICT - used by JPEG2000 lossy compressed images</li>
<li>YBR_RCT - used by JPEG2000 lossless compressed images</li>
</ul>
<p>Here is a short example of how to interpret the output of <a class="el" href="classvtkDICOMReader.html" title="Read DICOM image files.">vtkDICOMReader</a> for display: </p><div class="fragment"><div class="line">reader-&gt;Update();</div>
<div class="line"><a class="code" href="classvtkDICOMMetaData.html">vtkDICOMMetaData</a> *meta = reader-&gt;GetMetaData();</div>
<div class="line"><a class="code" href="classvtkDICOMValue.html">vtkDICOMValue</a> photometric = meta-&gt;<a class="code" href="classvtkDICOMMetaData.html#afabe46f14518d256e1e0efe476da623d">Get</a>(DC::PhotometricInterpretation)</div>
<div class="line"><span class="keywordflow">if</span> (photometric.<a class="code" href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">Matches</a>(<span class="stringliteral">&quot;MONOCHROME1&quot;</span>))</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// display with a lookup table that goes from white to black</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (photometric.<a class="code" href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">Matches</a>(<span class="stringliteral">&quot;MONOCHROME2&quot;</span>))</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// display with a lookup table that goes from black to white,</span></div>
<div class="line">  <span class="comment">// or display with a suitable pseudocolor lookup table</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (photometric.<a class="code" href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">Matches</a>(<span class="stringliteral">&quot;PALETTE*&quot;</span>))</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// display with palette lookup table (see vtkDICOMLookupTable),</span></div>
<div class="line">  <span class="comment">// or convert to RGB with vtkDICOMApplyPalette</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (photometric.<a class="code" href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">Matches</a>(<span class="stringliteral">&quot;RGB*&quot;</span>) || photometric.<a class="code" href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">Matches</a>(<span class="stringliteral">&quot;YBR*&quot;</span>))</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// display RGB data directly</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassvtkDICOMMetaData_html"><div class="ttname"><a href="classvtkDICOMMetaData.html">vtkDICOMMetaData</a></div><div class="ttdoc">A container class for DICOM metadata.</div><div class="ttdef"><b>Definition:</b> vtkDICOMMetaData.h:44</div></div>
<div class="ttc" id="aclassvtkDICOMMetaData_html_afabe46f14518d256e1e0efe476da623d"><div class="ttname"><a href="classvtkDICOMMetaData.html#afabe46f14518d256e1e0efe476da623d">vtkDICOMMetaData::Get</a></div><div class="ttdeci">const vtkDICOMValue &amp; Get(vtkDICOMTag tag)</div><div class="ttdoc">Get an attribute value.</div></div>
<div class="ttc" id="aclassvtkDICOMValue_html"><div class="ttname"><a href="classvtkDICOMValue.html">vtkDICOMValue</a></div><div class="ttdoc">A class to store attribute values for DICOM metadata.</div><div class="ttdef"><b>Definition:</b> vtkDICOMValue.h:51</div></div>
<div class="ttc" id="aclassvtkDICOMValue_html_af96b17eb8b4ca52891495f74cabdea7b"><div class="ttname"><a href="classvtkDICOMValue.html#af96b17eb8b4ca52891495f74cabdea7b">vtkDICOMValue::Matches</a></div><div class="ttdeci">bool Matches(const vtkDICOMValue &amp;value) const</div><div class="ttdoc">Check if the value matches the specified find query value.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md33"></a>
Grayscale image display</h1>
<p>DICOM defines a grayscale display pipeline that converts the <em>Stored Values</em> in the file to <em>Presentation Values</em> that are suitable for display. The details of how this is done are described in the <a href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.11.html">Lookup Tables and Presentation States</a> chapter of the DICOM standard. A brief summary of the steps in the grayscale display pipeline is as follows:</p>
<ol type="1">
<li><em>Stored Values</em> are rescaled to generate <em>Modality Values</em></li>
<li><em>Modality Values</em> are windowed to generate <em>Windowed Values</em> (or <em>Values of Interest</em>)</li>
<li><em>Windowed Values</em> are mapped to <em>Presentation Values</em></li>
</ol>
<p>The <em>Modality Values</em> are real values in units that are appropriate to the modality, for example, Hounsfield units for CT or counts for PET. The <b>RescaleIntercept</b> and <b>RescaleSlope</b> define a linear mapping from <em>Stored Values</em> to <em>Modality Values</em>: </p><pre class="fragment">ModalityValue = RescaleSlope * StoredValue + RescaleIntercept
</pre><p> For modalities such as ultrasound and MRI that do not have any units, the RescaleSlope and RescaleIntercept are absent and the <em>Modality Values</em> are equal to the <em>Stored Values</em>.</p>
<p>The <em>Windowed Values</em> (or more generically, <em>Values of Interest</em> or <em>VOIs</em>) represent the range of values to be displayed. Decreasing the <b>WindowWidth</b> increases the perceived contrast of the image, and decreasing the <b>WindowCenter</b> increases the perceived brightness of the image. Note that, as shown in the pseudocode below, the DICOM standard uses a definition of "window" and "level" that might be different from that to which you are accustomed. The DICOM WindowWidth must be greater than or equal to 1. </p><pre class="fragment">n = number of output gray levels (usually 256 or 1024)
w = WindowWidth - 1.0
c = WindowCenter - 0.5

if (ModalityValue &lt;= c - 0.5*w), then WindowedValue = 0
else if (ModalityValue &gt; c + 0.5*w), then WindowedValue = n - 1
else WindowedValue = ((ModalityValue - c)/w + 0.5) * (n - 1)
</pre><p> For ultrasound (and for 8-bit images in general) the WindowWidth and WindowCenter may be absent from the file. If absent, they can be assumed to be 256 and 128 respectively, which provides an 8-bit identity mapping. More information can be found in the <a href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.11.2.html">VOI LUT Module</a> of the DICOM standard. Note that a DICOM display application should allow the user to adjust the window according to his or her needs.</p>
<p>The <em>Presentation Values</em> are the values that are ultimately displayed to the user. If the PhotometricInterpretation is MONOCHROME2, then the <em>Windowed Values</em> should be displayed directly. If the the PhotometricInterpetation is MONOCHROME1, then the grayscale lookup table should be inverted such that a value of 0 is displayed as white and the maximum value is displayed as black.</p>
<h1><a class="anchor" id="autotoc_md34"></a>
Color image display</h1>
<p>There are several categories of color display for DICOM, the most important of which are:</p><ul>
<li>RGB (or YBR) values stored directly in the file</li>
<li>PALETTE COLOR where a palette LUT is applied to the stored values</li>
<li>A supplemental palette LUT applied to some or all stored values</li>
<li>A pseudo-color palette LUT applied to the windowed values</li>
</ul>
<p>For convenience, the <a class="el" href="classvtkDICOMApplyPalette.html" title="Apply palette to PALETTE COLOR images.">vtkDICOMApplyPalette</a> filter can convert a PALETTE COLOR image to RGB, or can convert an image with a supplemental palette to RGB, but will pass through all other images. For more information about supplemental palettes, see the <a href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.19.html">Supplemental Palette Lookup Table Module</a>. As an alternative to <a class="el" href="classvtkDICOMApplyPalette.html" title="Apply palette to PALETTE COLOR images.">vtkDICOMApplyPalette</a>, the palette lookup table can be retrieved from a DICOM data set with the <a class="el" href="classvtkDICOMLookupTable.html" title="Lookup tables from DICOM data.">vtkDICOMLookupTable</a> class.</p>
<p>The final category of color display, pseudo-color, is displayed as per the grayscale pipeline described above, except that a pseudocolor LUT is used in place of the black-to-white (MONOCHROME2) or white-to-black (MONOCHROME1) LUT. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 4 2024 20:30:16 for vtk-dicom by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
